/**
 * Formatted field widget
 * @version 1.0.2
 * @author mfyodorov
 * @license MIT
 */
function FormattedField(e,n){function r(){p=i(e.value),g=f(),d=h(),w=g.length,e.setAttribute("maxlength",w),e.setAttribute("minlength",x),t(e.value)||(e.value=a())}function t(e){if(e.length>w)return!1;for(var n in e){if(!o(g[n]).test(e[n]))return!1;if(!1!==l(n,e[n]))return!1}return!0}function u(e){return d.test(e)}function i(e){return e.replace(/\D*/g,"")}function a(){var e="",n=0;for(var r in g){if(p.length<=n)break;if("9"==g[r]){var t=l(r,p[n]);e+=!1!==t?t:p[n],n++}else e+=g[r]}return e}function f(){for(var e in v)if("default"!=e&&!0===new RegExp("^"+e).test(p))return v[e];return v["default"]}function l(n,r){if(n=parseInt(n)+1,C.hasOwnProperty(n))for(var t in C[n]){if(C[n][t].hasOwnProperty("self")&&new RegExp(C[n][t].self).test(r))return C[n][t].value;if(C[n][t].hasOwnProperty("all")&&new RegExp(C[n][t].all).test(e.value))return C[n][t].value}return!1}function o(e){var n=c(e);return new RegExp(n)}function c(e){return k.hasOwnProperty(e)?k[e]:e}function h(){var e=[],n="";for(var r in g)-1==e.indexOf(g[r])&&(e.push(g[r]),n+=c(g[r]));return new RegExp("["+n+"]")}function s(e){return null==e.which?e.keyCode<32?null:String.fromCharCode(e.keyCode):0!=e.which&&0!=e.charCode?e.which<32?null:String.fromCharCode(e.which):null}var v,p,g,w,d,y=n.pattern||"",m=n.customPattern||{},x=n.minlength||0,C=n.replace||{};(v=m)["default"]=y;var k={9:"\\d"," ":"\\s","+":"\\+","(":"\\(",")":"\\)",".":"\\."};!function(){r(),e.onkeypress=function(e){if(!((e=e||event).ctrlKey||e.altKey||e.metaKey)){var n=s(e);if(null!=n)return u(n)}},e.onkeyup=function(e){r()}}()}